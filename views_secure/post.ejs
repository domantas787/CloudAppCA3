<%- include('layout', { body: '' }) %>

<h2><%= post.title %></h2>
<p>By <%= post.username %> on <%= post.created_at %></p>

<div>
    <!-- content printed escaped to avoid XSS -->
  <pre><%= post.content %></pre>
</div>

<h3>Comments</h3>
<ul>
  <% comments.forEach(c => { %>
    <li>
      <strong><%= c.username %>:</strong>
      <span><%= c.content %></span>
    </li>
  <% }) %>
</ul>

<% if (user) { %>
  <h4>Add a comment</h4>
  <form action="/posts/<%= post.id %>/comments" method="POST">
    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
    <textarea name="content"></textarea>
    <button type="submit">Comment</button>
  </form>
<% } else { %>
  <p><a href="/login">Login</a> to comment.</p>
<% } %>
